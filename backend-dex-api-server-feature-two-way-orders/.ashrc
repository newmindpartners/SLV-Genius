#!/bin/sh

## Colorize the ls output ##
alias ls='ls --color=auto'

## Use a long listing format ##
alias ll='ls -lah'

## Show hidden files ##
alias l.='ls -d .* --color=auto'

alias cd..='cd ..'

POD_NAME=$(echo -n "${K8S_POD_NAME:=unknown-pod}" | tr 'a-z' 'A-Z')

## Initalize color variables for colorful output: ##
init_colors() {
  if [[ -t 2 ]] && [[ -z "${NO_COLOR-}" ]] && [[ "${TERM-}" != "dumb" ]]; then
    NOFORMAT='\033[0m' RED='\033[0;31m' GREEN='\033[0;32m' ORANGE='\033[0;33m' BLUE='\033[0;34m' PURPLE='\033[0;35m' CYAN='\033[0;36m' YELLOW='\033[1;33m'
  else
    NOFORMAT='' RED='' GREEN='' ORANGE='' BLUE='' PURPLE='' CYAN='' YELLOW=''
  fi
}

## Initalize the namespace variables: ##
init_namespace () {
    NAMESPACE=$(echo -n "${K8S_NAMESPACE:=UNKOWN}" | tr 'a-z' 'A-Z')
    NAMESPACE_LABEL="?"
    NAMESPACE_COLOR=$PURPLE

    if [[ "${NAMESPACE}" == "MAINNET" ]] ;then
         NAMESPACE_LABEL="MAINNET"
         NAMESPACE_COLOR=$RED
    fi
    if [[ "${NAMESPACE}" == "TESTNET" ]] ;then
         NAMESPACE_LABEL="TESTNET"
         NAMESPACE_COLOR=$BLUE
    fi
    if [[ "${NAMESPACE}" == "DEVELOPMENT" ]] ;then
         NAMESPACE_LABEL="DEVELOPMENT"
         NAMESPACE_COLOR=$GREEN
    fi
    if [[ "${NAMESPACE}" == "DEX" ]] ;then
         NAMESPACE_LABEL="DEVELOPMENT"
         NAMESPACE_COLOR=$GREEN
    fi
}

## Initialization: ##
init_colors
init_namespace

## Building blocks for the prompt: ##
PS_NAMESPACE=${NAMESPACE_COLOR}[${NAMESPACE_LABEL}]${NOFORMAT}
PS_POD=${YELLOW}$(echo $POD_NAME | cut -d- -f1,2)${NOFORMAT}

## Number of trailing directory components in the command prompt: ##
PROMPT_DIRTRIM=2

## Customize the primary command prompt shown in interactive shells: ##
export PS1=" $PS_NAMESPACE $PS_POD ${RED}\w > ${NOFORMAT}"

## Welcome messages for the user after starting an interactive shell: ##
echo -e "================================================================"
echo -e " Welcome to $PS_NAMESPACE $PS_POD! Enjoy your stay!             "
echo -e "  K8S_NAMESPACE: $NAMESPACE                                     "
echo -e "  K8S_POD_NAME : $POD_NAME                                      "
echo -e "  CI_REVISION  : ${CI_REVISION:=?}                              "
echo -e "  CI_BUILD_TIME: ${CI_BUILD_TIME:=?}                            "
echo -e "================================================================"
